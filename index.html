<!DOCTYPE html>
<html lang="id" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="description" content="Integrated Multi-Agentic AI: Biofisika ‚Ä¢ Nano-Tek ‚Ä¢ Ocean Science ‚Ä¢ Physical Intelligence" />
  <title>üß† Integrated Multi-Agentic AI</title>
  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com?plugins=typography,forms"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          colors: {
            'ai-blue': '#1D4ED8',
            'ai-teal': '#0D9488',
            'ai-dark': '#0F172A',
            'tron-blue': '#00d9ff',
            'tron-purple': '#9d4edd',
            'tron-cyan': '#00f5ff',
          },
          animation: {
            'pulse-slow': 'pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite',
            'glow': 'glow 2s ease-in-out infinite alternate',
          },
          keyframes: {
            glow: {
              '0%': { boxShadow: '0 0 5px #00d9ff, 0 0 10px #00d9ff' },
              '100%': { boxShadow: '0 0 20px #00d9ff, 0 0 30px #00d9ff' },
            }
          }
        }
      }
    }
  </script>
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@300;400;500&display=swap" rel="stylesheet">
  <!-- Icons -->
  <script src="https://unpkg.com/feather-icons"></script>
  <!-- Three.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
  <style>
    body {
      font-family: 'Inter', sans-serif;
      background: linear-gradient(135deg, #0a0e27 0%, #0f172a 50%, #0a0e27 100%);
      overflow-x: hidden;
    }
    .dark body {
      background: #0F172A;
    }
    .chat-bubble {
      max-width: 85%;
      padding: 1rem 1.25rem;
      border-radius: 1.5rem;
      margin-bottom: 1rem;
      line-height: 1.5;
    }
    .user { 
      background-color: #1D4ED8; 
      color: white; 
      margin-left: auto; 
      border-bottom-right-radius: 0.5rem;
    }
    .ai { 
      background-color: rgba(15, 23, 42, 0.8); 
      color: #e2e8f0; 
      margin-right: auto; 
      border-left: 4px solid #00d9ff;
      border-bottom-left-radius: 0.5rem;
      backdrop-filter: blur(10px);
    }
    .source-link {
      font-size: 0.8rem; 
      color: #00d9ff; 
      text-decoration: underline;
      margin-top: 0.5rem;
      display: block;
    }
    .voice-btn {
      width: 36px; 
      height: 36px;
      display: flex; 
      align-items: center; 
      justify-content: center;
      background: #0D9488; 
      color: white; 
      border: none; 
      border-radius: 50%;
      cursor: pointer; 
      transition: 0.2s;
    }
    .voice-btn:hover { 
      transform: scale(1.1); 
      background: #14b8a6; 
    }
    .upload-btn {
      padding: 0.5rem 1rem; 
      background: rgba(30, 41, 59, 0.8); 
      color: #e2e8f0;
      border: 1px solid rgba(71, 85, 105, 0.8); 
      border-radius: 0.5rem; 
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      backdrop-filter: blur(10px);
    }
    .typing-indicator {
      display: inline-flex;
      align-items: center;
      padding: 0.5rem 1rem;
      background-color: rgba(15, 23, 42, 0.8);
      border-radius: 1.5rem;
      margin-right: auto;
      border-left: 4px solid #00d9ff;
      backdrop-filter: blur(10px);
    }
    .typing-dot {
      height: 8px;
      width: 8px;
      border-radius: 50%;
      background-color: #00d9ff;
      margin: 0 2px;
      display: inline-block;
      animation: typing 1.4s infinite;
    }
    .typing-dot:nth-child(2) {
      animation-delay: 0.2s;
    }
    .typing-dot:nth-child(3) {
      animation-delay: 0.4s;
    }
    @keyframes typing {
      0%, 60%, 100% {
        transform: translateY(0);
      }
      30% {
        transform: translateY(-10px);
      }
    }
    .error-message {
      background-color: rgba(127, 29, 29, 0.8);
      color: #fecaca;
      padding: 0.75rem 1rem;
      border-radius: 0.5rem;
      margin: 0.5rem 0;
      border-left: 4px solid #ef4444;
      backdrop-filter: blur(10px);
    }
    .tron-grid {
      background-image: 
        linear-gradient(rgba(0, 217, 255, 0.1) 1px, transparent 1px),
        linear-gradient(90deg, rgba(0, 217, 255, 0.1) 1px, transparent 1px);
      background-size: 40px 40px;
    }
    .neon-glow {
      text-shadow: 0 0 10px #00d9ff, 0 0 20px #00d9ff, 0 0 30px #00d9ff;
    }
    .neon-border {
      border: 1px solid #00d9ff;
      box-shadow: 0 0 10px #00d9ff, inset 0 0 10px rgba(0, 217, 255, 0.2);
    }
    .neon-button {
      background: linear-gradient(45deg, #1a237e, #0d47a1);
      border: 1px solid #00d9ff;
      color: white;
      position: relative;
      overflow: hidden;
      z-index: 1;
      transition: all 0.3s;
    }
    .neon-button:before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(45deg, #00d9ff, #9d4edd);
      z-index: -1;
      opacity: 0;
      transition: opacity 0.3s;
    }
    .neon-button:hover {
      color: #000;
      box-shadow: 0 0 15px #00d9ff;
    }
    .neon-button:hover:before {
      opacity: 1;
    }
    .tab-active {
      background: rgba(0, 217, 255, 0.2);
      border-bottom: 2px solid #00d9ff;
    }
    #simulationCanvas {
      width: 100%;
      height: 100%;
      position: absolute;
      top: 0;
      left: 0;
      z-index: 0;
    }
    .simulation-overlay {
      position: relative;
      z-index: 10;
      background: rgba(10, 14, 39, 0.7);
      backdrop-filter: blur(5px);
    }
    .control-panel {
      background: rgba(15, 23, 42, 0.8);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(0, 217, 255, 0.3);
    }
    .artifact-card {
      background: rgba(15, 23, 42, 0.7);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(0, 217, 255, 0.3);
      transition: all 0.3s;
    }
    .artifact-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(0, 217, 255, 0.2);
      border-color: #00d9ff;
    }
    .artifact-icon {
      width: 60px;
      height: 60px;
      background: linear-gradient(135deg, #1a237e, #0d47a1);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto 1rem;
      box-shadow: 0 0 15px rgba(0, 217, 255, 0.5);
    }
    .login-input {
      background: rgba(30, 41, 59, 0.8);
      border: 1px solid rgba(0, 217, 255, 0.5);
      color: white;
    }
    .login-input:focus {
      border-color: #00d9ff;
      box-shadow: 0 0 0 3px rgba(0, 217, 255, 0.3);
    }
    .password-toggle {
      position: absolute;
      right: 10px;
      top: 50%;
      transform: translateY(-50%);
      cursor: pointer;
      color: #00d9ff;
    }
    .feature-card {
      background: rgba(15, 23, 42, 0.7);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(0, 217, 255, 0.3);
      transition: all 0.3s;
      height: 100%;
    }
    .feature-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(0, 217, 255, 0.2);
      border-color: #00d9ff;
    }
    .status-indicator {
      display: inline-block;
      width: 10px;
      height: 10px;
      border-radius: 50%;
      margin-right: 8px;
    }
    .status-online {
      background-color: #10b981;
      box-shadow: 0 0 5px #10b981;
    }
    .status-offline {
      background-color: #ef4444;
      box-shadow: 0 0 5px #ef4444;
    }
  </style>
</head>
<body class="min-h-screen text-white transition-colors duration-300 tron-grid">
  <!-- Login Screen -->
  <div id="loginScreen" class="flex flex-col items-center justify-center min-h-screen p-6">
    <div class="bg-gray-900 bg-opacity-80 p-8 rounded-2xl shadow-2xl w-full max-w-md border border-tron-blue neon-border">
      <div class="text-center mb-6">
        <div class="w-16 h-16 mx-auto bg-gradient-to-r from-tron-blue to-tron-purple rounded-full flex items-center justify-center text-white text-2xl font-bold mb-4 animate-pulse-slow">AI</div>
        <h1 class="text-2xl font-bold text-white neon-glow">üîê Masuk ke Sistem</h1>
        <p class="text-tron-cyan text-sm">Akses ke Integrated Multi-Agentic Intelligence</p>
      </div>
      
      <!-- Login Form -->
      <form id="loginForm" class="space-y-5">
        <div>
          <label class="block text-sm font-medium text-tron-cyan mb-1">Username</label>
          <input type="text" id="username" required
            class="w-full px-4 py-3 login-input rounded-xl focus:outline-none transition"/>
        </div>
        <div class="relative">
          <label class="block text-sm font-medium text-tron-cyan mb-1">Password</label>
          <input type="password" id="password" required
            class="w-full px-4 py-3 pr-12 login-input rounded-xl focus:outline-none transition"/>
          <span id="passwordToggle" class="password-toggle">
            <i data-feather="eye-off" class="w-5 h-5"></i>
          </span>
        </div>
        <button type="submit"
          class="w-full neon-button font-semibold py-3 rounded-xl transition transform hover:scale-105">
          Masuk ke Sistem AI
        </button>
      </form>
      
      <!-- Error Message -->
      <div id="loginError" class="hidden mt-4 p-3 bg-red-900 bg-opacity-50 rounded-lg text-red-300 text-sm">
        Username atau password salah.
      </div>
      
      <!-- Demo Credentials -->
      <div class="mt-6 p-4 bg-gray-800 bg-opacity-50 rounded-lg">
        <p class="text-tron-cyan text-sm font-medium mb-2">Demo Credentials:</p>
        <div class="text-xs space-y-1">
          <p><span class="text-white">Admin:</span> admin / ai4future</p>
          <p><span class="text-white">Guest:</span> guest / ocean2025</p>
        </div>
      </div>
      
      <!-- Direct Access Button -->
      <div class="mt-4 text-center">
        <button id="directAccessBtn" class="text-xs text-tron-cyan hover:text-white underline">
          Atau masuk sebagai demo user
        </button>
      </div>
    </div>
  </div>
  
  <!-- Main Interface -->
  <div id="mainInterface" class="hidden flex-col h-screen">
    <!-- Header -->
    <header class="bg-gray-900 bg-opacity-80 shadow-sm border-b border-tron-blue p-4 simulation-overlay">
      <div class="flex justify-between items-center">
        <div>
          <h1 class="text-2xl font-bold text-tron-blue neon-glow">üß† Integrated Multi-Agentic AI</h1>
          <p class="text-sm text-tron-cyan">
            Biofisika ‚Ä¢ Nano-Tek ‚Ä¢ Ocean Science ‚Ä¢ Physical Intelligence
          </p>
        </div>
        <div class="flex items-center space-x-3">
          <div class="flex items-center text-sm">
            <span id="apiStatus" class="status-indicator status-offline"></span>
            <span id="apiStatusText" class="text-tron-cyan">Offline</span>
          </div>
          <button id="darkModeToggle" class="text-tron-cyan hover:text-tron-blue">
            <i data-feather="moon" class="w-5 h-5"></i>
          </button>
          <button id="logoutBtn" class="text-sm bg-red-900 bg-opacity-50 hover:bg-red-800 text-red-300 px-3 py-1 rounded-lg transition">
            Keluar
          </button>
        </div>
      </div>
      
      <!-- Navigation Tabs -->
      <div class="flex mt-4 border-b border-tron-blue border-opacity-30">
        <button id="chatTab" class="px-4 py-2 font-medium tab-active transition">Chat Interface</button>
        <button id="simulationTab" class="px-4 py-2 font-medium text-tron-cyan hover:text-white transition">3D Simulation</button>
        <button id="featuresTab" class="px-4 py-2 font-medium text-tron-cyan hover:text-white transition">Features</button>
      </div>
    </header>
    
    <!-- Chat Interface -->
    <div id="chatInterface" class="flex-1 flex flex-col">
      <!-- Chat Body -->
      <div id="chat" class="flex-1 p-4 overflow-y-auto space-y-3">
        <div class="text-center text-tron-cyan text-sm italic">
          Selamat datang! Tanyakan apapun tentang Biofisika, Nanoteknologi, Ilmu Kelautan, atau AI Fisik.
        </div>
      </div>
      
      <!-- Input Area -->
      <div class="p-4 bg-gray-900 bg-opacity-80 border-t border-tron-blue simulation-overlay">
        <div class="flex flex-col space-y-2">
          <div class="flex space-x-2">
            <input
              id="userInput"
              type="text"
              placeholder="Tanya tentang struktur protein, sensor nano, arus laut, atau AI hemat energi..."
              class="flex-1 px-4 py-3 bg-gray-800 bg-opacity-70 border border-tron-blue rounded-xl text-white focus:ring-2 focus:ring-tron-cyan focus:outline-none"
              onkeyup="handleKeyPress(event)"
            />
            <button onclick="sendMessage()" class="bg-tron-blue hover:bg-tron-cyan text-white font-medium px-5 py-3 rounded-xl transition">
              <i data-feather="send" class="w-5 h-5"></i>
            </button>
          </div>
          <div class="flex space-x-2 items-center text-sm text-tron-cyan">
            <button onclick="startVoiceInput()" class="voice-btn" title="Input suara">
              <i data-feather="mic" class="w-4 h-4"></i>
            </button>
            <label class="upload-btn">
              <i data-feather="upload" class="w-4 h-4"></i>
              <span>Unggah Data</span>
              <input type="file" id="fileUpload" accept=".txt,.csv,.json" class="hidden" onchange="handleFileUpload(this)">
            </label>
            <span class="ml-auto">Mode: <strong>Multi-Agentic Fusion</strong></span>
          </div>
        </div>
      </div>
    </div>
    
    <!-- 3D Simulation Interface -->
    <div id="simulationInterface" class="hidden flex-1 relative">
      <canvas id="simulationCanvas"></canvas>
      
      <!-- Simulation Controls -->
      <div class="absolute top-4 left-4 control-panel p-4 rounded-xl w-64">
        <h3 class="text-lg font-bold text-tron-blue mb-3 neon-glow">Simulation Controls</h3>
        
        <div class="space-y-3">
          <div>
            <label class="block text-sm text-tron-cyan mb-1">Simulation Speed</label>
            <input type="range" id="speedControl" min="0.1" max="2" step="0.1" value="1" class="w-full">
          </div>
          
          <div>
            <label class="block text-sm text-tron-cyan mb-1">Artifact Type</label>
            <select id="artifactType" class="w-full bg-gray-800 border border-tron-blue rounded px-3 py-2 text-white">
              <option value="protein">Protein Structure</option>
              <option value="nano">Nano Sensor</option>
              <option value="ocean">Ocean Current</option>
              <option value="neural">Neural Network</option>
            </select>
          </div>
          
          <div>
            <label class="block text-sm text-tron-cyan mb-1">Grid Density</label>
            <input type="range" id="gridDensity" min="10" max="50" step="5" value="30" class="w-full">
          </div>
          
          <div>
            <label class="block text-sm text-tron-cyan mb-1">Particle Count</label>
            <input type="range" id="particleCount" min="100" max="1000" step="50" value="500" class="w-full">
          </div>
          
          <button id="resetSimulation" class="w-full neon-button py-2 rounded-lg mt-2">
            Reset Simulation
          </button>
        </div>
      </div>
      
      <!-- Artifact Info Panel -->
      <div class="absolute top-4 right-4 control-panel p-4 rounded-xl w-80">
        <h3 class="text-lg font-bold text-tron-blue mb-3 neon-glow">Artifact Information</h3>
        <div id="artifactInfo" class="space-y-3">
          <div class="artifact-card p-3 rounded-lg">
            <div class="artifact-icon">
              <i data-feather="activity" class="w-8 h-8 text-tron-cyan"></i>
            </div>
            <h4 class="font-bold text-center text-tron-blue">Protein Structure</h4>
            <p class="text-sm text-tron-cyan text-center mt-2">Simulasi struktur protein 3D dengan animasi interaktif</p>
          </div>
        </div>
      </div>
      
      <!-- Instructions -->
      <div class="absolute bottom-4 left-0 right-0 text-center">
        <p class="text-tron-cyan text-sm">Use mouse to rotate ‚Ä¢ Scroll to zoom ‚Ä¢ Right-click to pan</p>
      </div>
    </div>
    
    <!-- Features Interface -->
    <div id="featuresInterface" class="hidden flex-1 p-6 overflow-y-auto">
      <div class="max-w-6xl mx-auto">
        <h2 class="text-2xl font-bold text-tron-blue neon-glow mb-6">Fitur Canggih Integrated Multi-Agentic AI</h2>
        
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
          <!-- Feature 1 -->
          <div class="feature-card p-6 rounded-xl">
            <div class="artifact-icon mb-4">
              <i data-feather="cpu" class="w-8 h-8 text-tron-cyan"></i>
            </div>
            <h3 class="text-xl font-bold text-tron-blue mb-2">Multi-Agentic Processing</h3>
            <p class="text-tron-cyan mb-4">Sistem AI dengan beberapa agen spesialis yang bekerja sama untuk memberikan solusi komprehensif.</p>
            <ul class="text-sm text-gray-300 space-y-1">
              <li>‚Ä¢ Agen Biofisika</li>
              <li>‚Ä¢ Agen Nanoteknologi</li>
              <li>‚Ä¢ Agen Ilmu Kelautan</li>
              <li>‚Ä¢ Agen Physical Intelligence</li>
            </ul>
          </div>
          
          <!-- Feature 2 -->
          <div class="feature-card p-6 rounded-xl">
            <div class="artifact-icon mb-4">
              <i data-feather="box" class="w-8 h-8 text-tron-cyan"></i>
            </div>
            <h3 class="text-xl font-bold text-tron-blue mb-2">3D Simulation</h3>
            <p class="text-tron-cyan mb-4">Simulasi 3D interaktif untuk visualisasi konsep kompleks dengan tema futuristik Tron Legacy.</p>
            <ul class="text-sm text-gray-300 space-y-1">
              <li>‚Ä¢ Struktur Protein</li>
              <li>‚Ä¢ Sensor Nano</li>
              <li>‚Ä¢ Arus Laut</li>
              <li>‚Ä¢ Jaringan Neural</li>
            </ul>
          </div>
          
          <!-- Feature 3 -->
          <div class="feature-card p-6 rounded-xl">
            <div class="artifact-icon mb-4">
              <i data-feather="globe" class="w-8 h-8 text-tron-cyan"></i>
            </div>
            <h3 class="text-xl font-bold text-tron-blue mb-2">Real-time Data</h3>
            <p class="text-tron-cyan mb-4">Integrasi dengan sumber data ilmiah terkini untuk memberikan informasi yang akurat dan up-to-date.</p>
            <ul class="text-sm text-gray-300 space-y-1">
              <li>‚Ä¢ Protein Data Bank</li>
              <li>‚Ä¢ NOAA Ocean Data</li>
              <li>‚Ä¢ NanoHub Resources</li>
              <li>‚Ä¢ Global Ocean Observing System</li>
            </ul>
          </div>
          
          <!-- Feature 4 -->
          <div class="feature-card p-6 rounded-xl">
            <div class="artifact-icon mb-4">
              <i data-feather="zap" class="w-8 h-8 text-tron-cyan"></i>
            </div>
            <h3 class="text-xl font-bold text-tron-blue mb-2">Advanced AI</h3>
            <p class="text-tron-cyan mb-4">Didukung oleh model AI canggih (GPT-OSS-20B) untuk pemrosesan bahasa alami dan penalaran yang kompleks.</p>
            <ul class="text-sm text-gray-300 space-y-1">
              <li>‚Ä¢ Pemahaman Konteks</li>
              <li>‚Ä¢ Penalaran Multidisiplin</li>
              <li>‚Ä¢ Generasi Respons Kreatif</li>
              <li>‚Ä¢ Pembelajaran Berkelanjutan</li>
            </ul>
          </div>
          
          <!-- Feature 5 -->
          <div class="feature-card p-6 rounded-xl">
            <div class="artifact-icon mb-4">
              <i data-feather="message-circle" class="w-8 h-8 text-tron-cyan"></i>
            </div>
            <h3 class="text-xl font-bold text-tron-blue mb-2">Interactive Chat</h3>
            <p class="text-tron-cyan mb-4">Antarmuka percakapan yang intuitif dengan dukungan input suara dan unggah data untuk analisis mendalam.</p>
            <ul class="text-sm text-gray-300 space-y-1">
              <li>‚Ä¢ Input Teks & Suara</li>
              <li>‚Ä¢ Unggah File</li>
              <li>‚Ä¢ Riwayat Percakapan</li>
              <li>‚Ä¢ Respons Kontekstual</li>
            </ul>
          </div>
          
          <!-- Feature 6 -->
          <div class="feature-card p-6 rounded-xl">
            <div class="artifact-icon mb-4">
              <i data-feather="shield" class="w-8 h-8 text-tron-cyan"></i>
            </div>
            <h3 class="text-xl font-bold text-tron-blue mb-2">Secure & Private</h3>
            <p class="text-tron-cyan mb-4">Keamanan data dan privasi pengguna menjadi prioritas utama dengan enkripsi end-to-end.</p>
            <ul class="text-sm text-gray-300 space-y-1">
              <li>‚Ä¢ Enkripsi Data</li>
              <li>‚Ä¢ Autentikasi Pengguna</li>
              <li>‚Ä¢ Kontrol Akses</li>
              <li>‚Ä¢ Kepatuhan Regulasi</li>
            </ul>
          </div>
        </div>
        
        <!-- Technology Stack -->
        <div class="mt-12 p-6 bg-gray-900 bg-opacity-50 rounded-xl">
          <h3 class="text-xl font-bold text-tron-blue mb-4">Technology Stack</h3>
          <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
            <div class="text-center p-3 bg-gray-800 bg-opacity-50 rounded-lg">
              <div class="text-tron-cyan font-bold">Frontend</div>
              <div class="text-sm text-gray-400">HTML5, CSS3, JavaScript</div>
            </div>
            <div class="text-center p-3 bg-gray-800 bg-opacity-50 rounded-lg">
              <div class="text-tron-cyan font-bold">Framework</div>
              <div class="text-sm text-gray-400">Tailwind CSS, Three.js</div>
            </div>
            <div class="text-center p-3 bg-gray-800 bg-opacity-50 rounded-lg">
              <div class="text-tron-cyan font-bold">AI Model</div>
              <div class="text-sm text-gray-400">GPT-OSS-20B (Ollama)</div>
            </div>
            <div class="text-center p-3 bg-gray-800 bg-opacity-50 rounded-lg">
              <div class="text-tron-cyan font-bold">Deployment</div>
              <div class="text-sm text-gray-400">Vercel Edge Functions</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Scripts -->
  <script>
    // Global variables
    let scene, camera, renderer, controls;
    let simulationObjects = [];
    let animationId;
    let currentArtifact = 'protein';
    let isApiOnline = false;
    
    // API Configuration
    const API_CONFIG = {
      // Using a proxy to avoid CORS issues
      endpoint: 'https://cors-anywhere.herokuapp.com/https://api.ollama.com/api/generate',
      model: 'gpt-oss-20b',
      // This would normally be stored securely on the server
      apiKey: 'your-api-key-here'
    };
    
    // Initialize app
    document.addEventListener('DOMContentLoaded', function() {
      // Check if user is already logged in
      if (localStorage.getItem('isLoggedIn') === 'true') {
        showMainInterface();
      }
      
      // Setup login form
      const loginForm = document.getElementById('loginForm');
      if (loginForm) {
        loginForm.addEventListener('submit', function(e) {
          e.preventDefault();
          handleLogin();
        });
      }
      
      // Setup password toggle
      const passwordToggle = document.getElementById('passwordToggle');
      if (passwordToggle) {
        passwordToggle.addEventListener('click', function() {
          const passwordInput = document.getElementById('password');
          const icon = passwordToggle.querySelector('i');
          
          if (passwordInput.type === 'password') {
            passwordInput.type = 'text';
            icon.setAttribute('data-feather', 'eye');
          } else {
            passwordInput.type = 'password';
            icon.setAttribute('data-feather', 'eye-off');
          }
          feather.replace();
        });
      }
      
      // Setup direct access button
      const directAccessBtn = document.getElementById('directAccessBtn');
      if (directAccessBtn) {
        directAccessBtn.addEventListener('click', function() {
          // Auto-fill guest credentials
          document.getElementById('username').value = 'guest';
          document.getElementById('password').value = 'ocean2025';
          handleLogin();
        });
      }
      
      // Setup logout button
      const logoutBtn = document.getElementById('logoutBtn');
      if (logoutBtn) {
        logoutBtn.addEventListener('click', function() {
          localStorage.removeItem('isLoggedIn');
          location.reload();
        });
      }
      
      // Setup dark mode toggle
      const darkModeToggle = document.getElementById('darkModeToggle');
      if (darkModeToggle) {
        darkModeToggle.addEventListener('click', function() {
          document.body.classList.toggle('dark');
          const icon = darkModeToggle.querySelector('i');
          if (document.body.classList.contains('dark')) {
            icon.setAttribute('data-feather', 'sun');
          } else {
            icon.setAttribute('data-feather', 'moon');
          }
          feather.replace();
        });
      }
      
      // Setup tabs
      const chatTab = document.getElementById('chatTab');
      const simulationTab = document.getElementById('simulationTab');
      const featuresTab = document.getElementById('featuresTab');
      
      if (chatTab) {
        chatTab.addEventListener('click', function() {
          showChatInterface();
        });
      }
      
      if (simulationTab) {
        simulationTab.addEventListener('click', function() {
          showSimulationInterface();
        });
      }
      
      if (featuresTab) {
        featuresTab.addEventListener('click', function() {
          showFeaturesInterface();
        });
      }
      
      // Initialize feather icons
      feather.replace();
      
      // Check API status
      checkApiStatus();
    });
    
    // Check API status
    async function checkApiStatus() {
      try {
        // For demo purposes, we'll simulate API status check
        // In a real implementation, you would ping your API endpoint
        setTimeout(() => {
          isApiOnline = true;
          updateApiStatus(true);
        }, 2000);
      } catch (error) {
        console.error('API status check failed:', error);
        isApiOnline = false;
        updateApiStatus(false);
      }
    }
    
    // Update API status UI
    function updateApiStatus(isOnline) {
      const statusIndicator = document.getElementById('apiStatus');
      const statusText = document.getElementById('apiStatusText');
      
      if (statusIndicator && statusText) {
        if (isOnline) {
          statusIndicator.classList.remove('status-offline');
          statusIndicator.classList.add('status-online');
          statusText.textContent = 'Online';
        } else {
          statusIndicator.classList.remove('status-online');
          statusIndicator.classList.add('status-offline');
          statusText.textContent = 'Offline';
        }
      }
    }
    
    // Handle login
    function handleLogin() {
      const username = document.getElementById('username').value;
      const password = document.getElementById('password').value;
      const loginError = document.getElementById('loginError');
      
      // Reset error message
      if (loginError) {
        loginError.classList.add('hidden');
      }
      
      // Validate credentials
      if ((username === 'admin' && password === 'ai4future') || 
          (username === 'guest' && password === 'ocean2025')) {
        // Set login state
        localStorage.setItem('isLoggedIn', 'true');
        
        // Show main interface
        showMainInterface();
      } else {
        // Show error message
        if (loginError) {
          loginError.classList.remove('hidden');
        }
      }
    }
    
    // Show main interface
    function showMainInterface() {
      const loginScreen = document.getElementById('loginScreen');
      const mainInterface = document.getElementById('mainInterface');
      
      if (loginScreen) {
        loginScreen.classList.add('hidden');
      }
      
      if (mainInterface) {
        mainInterface.classList.remove('hidden');
        mainInterface.classList.add('flex');
        
        // Show welcome message
        setTimeout(() => {
          appendMessage("Halo! Saya adalah Integrated Multi-Agentic AI yang mengintegrasikan Biofisika, Nanoteknologi, Ilmu Kelautan, dan Physical Intelligence. Apa yang bisa saya bantu hari ini?", 'ai');
        }, 300);
      }
    }
    
    // Show chat interface
    function showChatInterface() {
      const chatInterface = document.getElementById('chatInterface');
      const simulationInterface = document.getElementById('simulationInterface');
      const featuresInterface = document.getElementById('featuresInterface');
      const chatTab = document.getElementById('chatTab');
      const simulationTab = document.getElementById('simulationTab');
      const featuresTab = document.getElementById('featuresTab');
      
      if (chatInterface) {
        chatInterface.classList.remove('hidden');
      }
      
      if (simulationInterface) {
        simulationInterface.classList.add('hidden');
      }
      
      if (featuresInterface) {
        featuresInterface.classList.add('hidden');
      }
      
      if (chatTab) {
        chatTab.classList.add('tab-active');
      }
      
      if (simulationTab) {
        simulationTab.classList.remove('tab-active');
      }
      
      if (featuresTab) {
        featuresTab.classList.remove('tab-active');
      }
      
      // Stop simulation when switching to chat
      if (animationId) {
        cancelAnimationFrame(animationId);
      }
    }
    
    // Show simulation interface
    function showSimulationInterface() {
      const chatInterface = document.getElementById('chatInterface');
      const simulationInterface = document.getElementById('simulationInterface');
      const featuresInterface = document.getElementById('featuresInterface');
      const chatTab = document.getElementById('chatTab');
      const simulationTab = document.getElementById('simulationTab');
      const featuresTab = document.getElementById('featuresTab');
      
      if (chatInterface) {
        chatInterface.classList.add('hidden');
      }
      
      if (simulationInterface) {
        simulationInterface.classList.remove('hidden');
      }
      
      if (featuresInterface) {
        featuresInterface.classList.add('hidden');
      }
      
      if (chatTab) {
        chatTab.classList.remove('tab-active');
      }
      
      if (simulationTab) {
        simulationTab.classList.add('tab-active');
      }
      
      if (featuresTab) {
        featuresTab.classList.remove('tab-active');
      }
      
      // Initialize or resume simulation
      if (!scene) {
        initSimulation();
      } else {
        animate();
      }
    }
    
    // Show features interface
    function showFeaturesInterface() {
      const chatInterface = document.getElementById('chatInterface');
      const simulationInterface = document.getElementById('simulationInterface');
      const featuresInterface = document.getElementById('featuresInterface');
      const chatTab = document.getElementById('chatTab');
      const simulationTab = document.getElementById('simulationTab');
      const featuresTab = document.getElementById('featuresTab');
      
      if (chatInterface) {
        chatInterface.classList.add('hidden');
      }
      
      if (simulationInterface) {
        simulationInterface.classList.add('hidden');
      }
      
      if (featuresInterface) {
        featuresInterface.classList.remove('hidden');
      }
      
      if (chatTab) {
        chatTab.classList.remove('tab-active');
      }
      
      if (simulationTab) {
        simulationTab.classList.remove('tab-active');
      }
      
      if (featuresTab) {
        featuresTab.classList.add('tab-active');
      }
      
      // Stop simulation when switching to features
      if (animationId) {
        cancelAnimationFrame(animationId);
      }
    }
    
    // Voice Input
    function startVoiceInput() {
      if (!('webkitSpeechRecognition' in window || 'SpeechRecognition' in window)) {
        appendMessage("Maaf, browser Anda tidak mendukung input suara.", 'ai');
        return;
      }
      
      const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
      recognition.lang = 'id-ID';
      recognition.interimResults = false;
      recognition.start();
      
      recognition.onresult = (event) => {
        document.getElementById('userInput').value = event.results[0][0].transcript;
      };
      
      recognition.onerror = (event) => {
        appendMessage("Terjadi kesalahan dalam pengenalan suara. Silakan coba lagi.", 'ai');
      };
    }
    
    // File Upload
    function handleFileUpload(input) {
      const file = input.files[0];
      if (!file) return;
      
      const reader = new FileReader();
      reader.onload = function(e) {
        const content = e.target.result.substring(0, 200);
        appendMessage(`üìÅ File "${file.name}" diunggah. Konten: ${content}...`, 'user');
        appendMessage(`Terima kasih. Data dari ${file.name} sedang dianalisis dengan AI agen khusus...`, 'ai');
      };
      reader.readAsText(file);
    }
    
    // Send Message
    let isWaiting = false;
    
    async function sendMessage() {
      if (isWaiting) return;
      
      const input = document.getElementById('userInput');
      const msg = input.value.trim();
      if (!msg) return;
      
      appendMessage(msg, 'user');
      input.value = '';
      isWaiting = true;
      
      // Show typing indicator
      showTypingIndicator();
      
      try {
        // Try to use Ollama API first
        if (isApiOnline) {
          try {
            const response = await callOllamaAPI(msg);
            removeTypingIndicator();
            appendMessage(response, 'ai');
            isWaiting = false;
            return;
          } catch (error) {
            console.error('Ollama API error:', error);
            // Fall back to mock response
          }
        }
        
        // Mock response if API is not available
        setTimeout(() => {
          removeTypingIndicator();
          const mockResponse = generateMockResponse(msg);
          appendMessage(mockResponse, 'ai');
          isWaiting = false;
        }, 1500);
      } catch (error) {
        console.error('Send message error:', error);
        removeTypingIndicator();
        appendMessage("Maaf, terjadi kesalahan. Silakan coba lagi.", 'ai');
        isWaiting = false;
      }
    }
    
    // Call Ollama API
    async function callOllamaAPI(message) {
      // In a real implementation, this would call your backend API
      // which would then call the Ollama API with your secured API key
      
      // For demo purposes, we'll simulate an API call
      return new Promise((resolve, reject) => {
        setTimeout(() => {
          // Simulate API response
          const responses = [
            "Saya telah menganalisis pertanyaan Anda tentang " + message + ". Berdasarkan data terbaru dari berbagai sumber ilmiah, dapat saya simpulkan bahwa...",
            "Terima kasih atas pertanyaan Anda. Sebagai Integrated Multi-Agentic AI, saya telah mengkonsultasikan agen spesialis untuk memberikan jawaban komprehensif.",
            "Berdasarkan penelitian terkini di bidang ini, " + message + " memiliki implikasi penting untuk pengembangan teknologi masa depan.",
            "Setelah memproses data dari berbagai disiplin ilmu, saya dapat memberikan perspektif multidimensi mengenai " + message + "."
          ];
          
          const randomResponse = responses[Math.floor(Math.random() * responses.length)];
          resolve(randomResponse);
        }, 1000);
      });
    }
    
    // Generate mock response
    function generateMockResponse(message) {
      const responses = {
        "struktur protein": "Struktur protein adalah organisasi tiga dimensi dari atom-atom dalam molekul protein. Struktur ini menentukan fungsi protein dalam tubuh. Dengan menggunakan teknologi seperti AlphaFold, kita sekarang dapat memprediksi struktur protein dengan akurasi tinggi, yang membantu dalam pengembangan obat dan terapi baru.",
        "sensor nano": "Sensor nano adalah perangkat yang sangat kecil (nanometer) yang dapat mendeteksi perubahan lingkungan dengan sensitivitas tinggi. Aplikasinya meliputi deteksi penyakit dini, pemantauan lingkungan, dan keamanan. Sensor nano bekerja berdasarkan perubahan sifat listrik, mekanik, atau optik saat terpapar target spesifik.",
        "arus laut": "Arus laut adalah pergerakan massa air laut yang dipengaruhi oleh angin, perbedaan suhu, dan gravitasi. Arus laut memainkan peran penting dalam regulasi iklim global dengan mendistribusikan panas di seluruh samudra. Arus seperti Gulf Stream mempengaruhi cuaca di berbagai belahan dunia.",
        "default": "Sebagai Integrated Multi-Agentic AI, saya mengintegrasikan pengetahuan dari berbagai disiplin ilmu untuk memberikan jawaban komprehensif. Pertanyaan Anda tentang '" + message + "' melibatkan beberapa bidang keahlian yang saya miliki. Dapatkah Anda memberikan lebih detail agar saya dapat memberikan jawaban yang lebih spesifik?"
      };
      
      const lowerMessage = message.toLowerCase();
      
      if (lowerMessage.includes("protein")) {
        return responses["struktur protein"];
      } else if (lowerMessage.includes("nano") || lowerMessage.includes("sensor")) {
        return responses["sensor nano"];
      } else if (lowerMessage.includes("arus") || lowerMessage.includes("laut") || lowerMessage.includes("ocean")) {
        return responses["arus laut"];
      } else {
        return responses["default"];
      }
    }
    
    function handleKeyPress(e) {
      if (e.key === 'Enter') sendMessage();
    }
    
    function appendMessage(text, sender) {
      const chat = document.getElementById('chat');
      if (!chat) return;
      
      const bubble = document.createElement('div');
      bubble.className = `chat-bubble ${sender}`;
      
      // Process links in AI messages
      if (sender === 'ai') {
        // Simple link detection - replace URLs with actual links
        const urlRegex = /(https?:\/\/[^\s]+)/g;
        text = text.replace(urlRegex, '<a href="$1" target="_blank" class="source-link">$1</a>');
        bubble.innerHTML = text;
      } else {
        bubble.innerText = text;
      }
      
      chat.appendChild(bubble);
      // Auto-scroll
      chat.scrollTop = chat.scrollHeight;
    }
    
    function showTypingIndicator() {
      const chat = document.getElementById('chat');
      if (!chat) return;
      
      const indicator = document.createElement('div');
      indicator.id = 'typingIndicator';
      indicator.className = 'typing-indicator';
      indicator.innerHTML = `
        <span class="typing-dot"></span>
        <span class="typing-dot"></span>
        <span class="typing-dot"></span>
      `;
      chat.appendChild(indicator);
      chat.scrollTop = chat.scrollHeight;
    }
    
    function removeTypingIndicator() {
      const indicator = document.getElementById('typingIndicator');
      if (indicator) {
        indicator.remove();
      }
    }
    
    // 3D Simulation Functions
    function initSimulation() {
      const container = document.getElementById('simulationCanvas');
      if (!container) return;
      
      const width = container.clientWidth;
      const height = container.clientHeight;
      
      // Scene setup
      scene = new THREE.Scene();
      scene.fog = new THREE.Fog(0x0a0e27, 10, 100);
      
      // Camera setup
      camera = new THREE.PerspectiveCamera(75, width / height, 0.1, 1000);
      camera.position.z = 30;
      
      // Renderer setup
      renderer = new THREE.WebGLRenderer({ 
        canvas: container, 
        antialias: true,
        alpha: true 
      });
      renderer.setSize(width, height);
      renderer.setPixelRatio(window.devicePixelRatio);
      
      // Controls
      controls = new THREE.OrbitControls(camera, renderer.domElement);
      controls.enableDamping = true;
      controls.dampingFactor = 0.05;
      
      // Lighting
      const ambientLight = new THREE.AmbientLight(0x00d9ff, 0.5);
      scene.add(ambientLight);
      
      const directionalLight = new THREE.DirectionalLight(0x00f5ff, 1);
      directionalLight.position.set(1, 1, 1);
      scene.add(directionalLight);
      
      // Grid
      createGrid();
      
      // Create initial artifact
      createArtifact(currentArtifact);
      
      // Handle window resize
      window.addEventListener('resize', onWindowResize);
      
      // Setup controls
      setupSimulationControls();
      
      // Start animation
      animate();
    }
    
    function createGrid() {
      if (!scene) return;
      
      const gridDensity = document.getElementById('gridDensity');
      const density = gridDensity ? parseInt(gridDensity.value) : 30;
      
      const gridHelper = new THREE.GridHelper(100, density, 0x00d9ff, 0x00d9ff);
      gridHelper.material.opacity = 0.2;
      gridHelper.material.transparent = true;
      scene.add(gridHelper);
    }
    
    function createArtifact(type) {
      if (!scene) return;
      
      // Clear previous artifacts
      simulationObjects.forEach(obj => {
        scene.remove(obj);
      });
      simulationObjects = [];
      
      // Update artifact info
      updateArtifactInfo(type);
      
      switch(type) {
        case 'protein':
          createProteinStructure();
          break;
        case 'nano':
          createNanoSensor();
          break;
        case 'ocean':
          createOceanCurrent();
          break;
        case 'neural':
          createNeuralNetwork();
          break;
      }
    }
    
    function createProteinStructure() {
      if (!scene) return;
      
      const group = new THREE.Group();
      
      // Create a helix structure representing protein
      const curve = new THREE.CatmullRomCurve3([
        new THREE.Vector3(-10, 0, 0),
        new THREE.Vector3(-5, 5, 5),
        new THREE.Vector3(0, 0, 10),
        new THREE.Vector3(5, -5, 5),
        new THREE.Vector3(10, 0, 0)
      ]);
      
      const tubeGeometry = new THREE.TubeGeometry(curve, 64, 0.5, 8, false);
      const tubeMaterial = new THREE.MeshPhongMaterial({ 
        color: 0x00d9ff,
        emissive: 0x00d9ff,
        emissiveIntensity: 0.2,
        shininess: 100
      });
      
      const tube = new THREE.Mesh(tubeGeometry, tubeMaterial);
      group.add(tube);
      
      // Add atoms
      for (let i = 0; i < 20; i++) {
        const t = i / 20;
        const point = curve.getPoint(t);
        
        const sphereGeometry = new THREE.SphereGeometry(0.8, 16, 16);
        const sphereMaterial = new THREE.MeshPhongMaterial({ 
          color: i % 2 === 0 ? 0x9d4edd : 0x00f5ff,
          emissive: i % 2 === 0 ? 0x9d4edd : 0x00f5ff,
          emissiveIntensity: 0.3
        });
        
        const sphere = new THREE.Mesh(sphereGeometry, sphereMaterial);
        sphere.position.copy(point);
        group.add(sphere);
      }
      
      scene.add(group);
      simulationObjects.push(group);
    }
    
    function createNanoSensor() {
      if (!scene) return;
      
      const group = new THREE.Group();
      
      // Create a complex geometric structure
      const geometry = new THREE.IcosahedronGeometry(8, 1);
      const material = new THREE.MeshPhongMaterial({ 
        color: 0x00f5ff,
        emissive: 0x00f5ff,
        emissiveIntensity: 0.1,
        wireframe: true
      });
      
      const icosahedron = new THREE.Mesh(geometry, material);
      group.add(icosahedron);
      
      // Add smaller spheres around
      for (let i = 0; i < 12; i++) {
        const phi = Math.acos(-1 + (2 * i) / 12);
        const theta = Math.sqrt(12 * Math.PI) * phi;
        
        const x = 12 * Math.cos(theta) * Math.sin(phi);
        const y = 12 * Math.sin(theta) * Math.sin(phi);
        const z = 12 * Math.cos(phi);
        
        const sphereGeometry = new THREE.SphereGeometry(1, 16, 16);
        const sphereMaterial = new THREE.MeshPhongMaterial({ 
          color: 0x9d4edd,
          emissive: 0x9d4edd,
          emissiveIntensity: 0.3
        });
        
        const sphere = new THREE.Mesh(sphereGeometry, sphereMaterial);
        sphere.position.set(x, y, z);
        group.add(sphere);
      }
      
      scene.add(group);
      simulationObjects.push(group);
    }
    
    function createOceanCurrent() {
      if (!scene) return;
      
      const group = new THREE.Group();
      
      // Get particle count from control
      const particleControl = document.getElementById('particleCount');
      const particleCount = particleControl ? parseInt(particleControl.value) : 500;
      
      // Create flowing particles representing ocean current
      const particles = new THREE.BufferGeometry();
      const positions = new Float32Array(particleCount * 3);
      
      for (let i = 0; i < particleCount; i++) {
        const i3 = i * 3;
        positions[i3] = (Math.random() - 0.5) * 50;
        positions[i3 + 1] = (Math.random() - 0.5) * 50;
        positions[i3 + 2] = (Math.random() - 0.5) * 50;
      }
      
      particles.setAttribute('position', new THREE.BufferAttribute(positions, 3));
      
      const particleMaterial = new THREE.PointsMaterial({
        color: 0x00d9ff,
        size: 0.5,
        transparent: true,
        opacity: 0.8,
        blending: THREE.AdditiveBlending
      });
      
      const particleSystem = new THREE.Points(particles, particleMaterial);
      group.add(particleSystem);
      
      // Create flow lines
      for (let i = 0; i < 20; i++) {
        const curve = new THREE.CatmullRomCurve3([
          new THREE.Vector3(-20, (Math.random() - 0.5) * 20, (Math.random() - 0.5) * 20),
          new THREE.Vector3(0, (Math.random() - 0.5) * 20, (Math.random() - 0.5) * 20),
          new THREE.Vector3(20, (Math.random() - 0.5) * 20, (Math.random() - 0.5) * 20)
        ]);
        
        const tubeGeometry = new THREE.TubeGeometry(curve, 20, 0.2, 8, false);
        const tubeMaterial = new THREE.MeshBasicMaterial({ 
          color: 0x00f5ff,
          transparent: true,
          opacity: 0.6
        });
        
        const tube = new THREE.Mesh(tubeGeometry, tubeMaterial);
        group.add(tube);
      }
      
      scene.add(group);
      simulationObjects.push(group);
    }
    
    function createNeuralNetwork() {
      if (!scene) return;
      
      const group = new THREE.Group();
      
      // Create nodes
      const nodeCount = 30;
      const nodes = [];
      
      for (let i = 0; i < nodeCount; i++) {
        const geometry = new THREE.SphereGeometry(1, 16, 16);
        const material = new THREE.MeshPhongMaterial({ 
          color: 0x9d4edd,
          emissive: 0x9d4edd,
          emissiveIntensity: 0.3
        });
        
        const node = new THREE.Mesh(geometry, material);
        node.position.set(
          (Math.random() - 0.5) * 30,
          (Math.random() - 0.5) * 30,
          (Math.random() - 0.5) * 30
        );
        
        group.add(node);
        nodes.push(node);
      }
      
      // Create connections
      for (let i = 0; i < nodeCount; i++) {
        for (let j = i + 1; j < nodeCount; j++) {
          if (Math.random() > 0.7) { // 30% chance of connection
            const geometry = new THREE.BufferGeometry().setFromPoints([
              nodes[i].position,
              nodes[j].position
            ]);
            
            const material = new THREE.LineBasicMaterial({ 
              color: 0x00d9ff,
              transparent: true,
              opacity: 0.5
            });
            
            const line = new THREE.Line(geometry, material);
            group.add(line);
          }
        }
      }
      
      scene.add(group);
      simulationObjects.push(group);
    }
    
    function updateArtifactInfo(type) {
      const infoContainer = document.getElementById('artifactInfo');
      if (!infoContainer) return;
      
      const artifactData = {
        protein: {
          icon: 'activity',
          title: 'Protein Structure',
          description: 'Simulasi struktur protein 3D dengan animasi interaktif'
        },
        nano: {
          icon: 'cpu',
          title: 'Nano Sensor',
          description: 'Representasi sensor nano dengan struktur kompleks'
        },
        ocean: {
          icon: 'droplet',
          title: 'Ocean Current',
          description: 'Visualisasi arus laut dengan partikel dan aliran'
        },
        neural: {
          icon: 'zap',
          title: 'Neural Network',
          description: 'Jaringan saraf tiruan dengan node dan koneksi'
        }
      };
      
      const data = artifactData[type];
      infoContainer.innerHTML = `
        <div class="artifact-card p-3 rounded-lg">
          <div class="artifact-icon">
            <i data-feather="${data.icon}" class="w-8 h-8 text-tron-cyan"></i>
          </div>
          <h4 class="font-bold text-center text-tron-blue">${data.title}</h4>
          <p class="text-sm text-tron-cyan text-center mt-2">${data.description}</p>
        </div>
      `;
      
      // Re-initialize feather icons
      feather.replace();
    }
    
    function setupSimulationControls() {
      // Speed control
      const speedControl = document.getElementById('speedControl');
      if (speedControl) {
        speedControl.addEventListener('input', (e) => {
          // This will be used in the animation loop
        });
      }
      
      // Artifact type
      const artifactType = document.getElementById('artifactType');
      if (artifactType) {
        artifactType.addEventListener('change', (e) => {
          currentArtifact = e.target.value;
          createArtifact(currentArtifact);
        });
      }
      
      // Grid density
      const gridDensity = document.getElementById('gridDensity');
      if (gridDensity) {
        gridDensity.addEventListener('input', (e) => {
          // Update grid density
          const grid = scene.children.find(child => child.type === 'GridHelper');
          if (grid) {
            scene.remove(grid);
            createGrid();
          }
        });
      }
      
      // Particle count
      const particleCount = document.getElementById('particleCount');
      if (particleCount) {
        particleCount.addEventListener('input', (e) => {
          // Update particle count for ocean current
          if (currentArtifact === 'ocean') {
            createArtifact('ocean');
          }
        });
      }
      
      // Reset simulation
      const resetSimulation = document.getElementById('resetSimulation');
      if (resetSimulation) {
        resetSimulation.addEventListener('click', () => {
          createArtifact(currentArtifact);
        });
      }
    }
    
    function animate() {
      animationId = requestAnimationFrame(animate);
      
      const speedControl = document.getElementById('speedControl');
      const speed = speedControl ? parseFloat(speedControl.value) : 1;
      
      // Rotate artifacts
      simulationObjects.forEach(obj => {
        obj.rotation.x += 0.005 * speed;
        obj.rotation.y += 0.01 * speed;
      });
      
      if (controls) {
        controls.update();
      }
      
      if (renderer && scene && camera) {
        renderer.render(scene, camera);
      }
    }
    
    function onWindowResize() {
      const container = document.getElementById('simulationCanvas');
      if (!container || !camera || !renderer) return;
      
      const width = container.clientWidth;
      const height = container.clientHeight;
      
      camera.aspect = width / height;
      camera.updateProjectionMatrix();
      renderer.setSize(width, height);
    }
  </script>
</body>
</html>
